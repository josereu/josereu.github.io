<!DOCTYPE html>
<html lang="en">

<head>
     <meta charset="UTF-8">
     <meta http-equiv="X-UA-Compatible" content="IE=edge">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>Document</title>
     <link href="estilo.css" rel=stylesheet>
</head>

<body>
     <div id="contenedor">
          <div class="contenedorBotones">
               <button id="startRecognizeAsyncButton">Iniciar</button>
               <button id="stopRecognizeAsyncButton">Cancelar</button>
               <button id="nuevaBusqueda">Nueva b√∫squeda</button>
          </div>
          <div class="contenedorResultado">
               <input id="phraseDiv" type="text">
          </div>
     </div>
</body>
<script src="sdk/microsoft.cognitiveservices.speech.sdk.bundle-min.js"></script>
<script>
     var subscriptionKey = "ee745a61cf044b49b3f0503de9728a18";
     var serviceRegion = "southcentralus";
     var phraseDiv;
     var startRecognizeAsyncButton;
     var stopRecognizeAsyncButton;
     var nuevaBusqueda;
     var SpeechSDK;
     var recognizer;
     document.addEventListener("DOMContentLoaded", function () {
          startRecognizeAsyncButton = document.getElementById("startRecognizeAsyncButton");
          stopRecognizeAsyncButton = document.getElementById("stopRecognizeAsyncButton");
          nuevaBusqueda = document.getElementById("nuevaBusqueda");
          stopRecognizeAsyncButton.disabled = true;
          phraseDiv = document.getElementById("phraseDiv");
          var speechConfig;
          speechConfig = SpeechSDK.SpeechConfig.fromSubscription(subscriptionKey, serviceRegion);
          speechConfig.speechRecognitionLanguage = "es-ES";
          var audioConfig = SpeechSDK.AudioConfig.fromDefaultMicrophoneInput();
          recognizer = new SpeechSDK.SpeechRecognizer(speechConfig, audioConfig);
          startRecognizeAsyncButton.addEventListener("click", function () {
               startRecognizeAsyncButton.disabled = true;
               stopRecognizeAsyncButton.disabled = false;
               phraseDiv.innerHTML = "";
               recognizer.startContinuousRecognitionAsync();
               recognizer.recognized = function (s, e) {
                    phraseDiv.value += e.result.text;
               };
          });

          stopRecognizeAsyncButton.addEventListener("click", function () {
               startRecognizeAsyncButton.disabled = false;
               stopRecognizeAsyncButton.disabled = true;
               recognizer.stopContinuousRecognitionAsync();

          });

          nuevaBusqueda.addEventListener("click",function(){
               phraseDiv.value = "";
          });

          if (!!window.SpeechSDK) {
               SpeechSDK = window.SpeechSDK;
               startRecognizeAsyncButton.disabled = false;
               if (typeof RequestAuthorizationToken === "function") {
                    RequestAuthorizationToken();
               }
          }
     });
</script>

</html>